<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>忘记密码</title>
    <link rel="stylesheet" href="./css/forgetPwd.css">
    <script src="./js/jquery-3.7.1.min.js"></script>
    <script>
        $(document).ready(function () {
            $(".reset-btn").click(() => {
                const id = $(".id").val();
                const password = $(".password").val();
                if (id == "" || password == "") {
                    alert("身份证号或新密码不能为空!");
                    return;
                }
                $.ajax({
                    url: "http://www.dony.cn:5000/resetPassword",
                    type: "post",
                    data: {
                        "id": id,
                        "password": password
                    },
                    success: (result) => {
                        if (result == "1") {
                            alert("密码重置成功，请重新登录");
                            window.location.href = "/login.html";
                        }
                        else {
                            alert("密码重置失败，请检查身份证号是否正确");
                        }
                    },
                    error: () => {
                        alert("服务器错误，请稍后重试");
                    }
                });
            });
        });
    </script>
</head>

<body>
    <div class="main-wrapper">
        <div class="header">
            <img src="./img/DONYLOGO.jpg" alt="DONY" class="logo">
        </div>

        <div class="container">
            <div class="card">
                <div class="card_body">
                    <h1 class="login-title">忘记密码</h1>

                    <form action="/" method="post" class="login-form">
                        <div class="form-group">
                            <label for="id">身份证号</label>
                            <input class="info id" type="text" id="id" placeholder="请输入身份证号">
                        </div>

                        <div class="form-group">
                            <label for="password">新密码</label>
                            <input class="info password" type="password" id="password" placeholder="请输入新密码">
                        </div>

                        <button type="button" class="reset-btn">重置密码</button>
                    </form>
                </div>
            </div>
        </div>

        <div class="footer">
            <span class="footer-text">记得密码了?</span>
            <a class="login-link" href="./login.html">返回登录</a>
        </div>
    </div>
</body>

</html>